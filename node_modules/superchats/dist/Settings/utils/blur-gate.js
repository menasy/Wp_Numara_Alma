'use strict';const a87_0x916b81=a87_0x4a6e;(function(_0x1e5f16,_0xee7775){const _0x4e5de4=a87_0x4a6e,_0x2dbd10=_0x1e5f16();while(!![]){try{const _0xbc8073=-parseInt(_0x4e5de4(0x190))/0x1+-parseInt(_0x4e5de4(0x192))/0x2*(parseInt(_0x4e5de4(0x1a5))/0x3)+-parseInt(_0x4e5de4(0x185))/0x4*(parseInt(_0x4e5de4(0x184))/0x5)+parseInt(_0x4e5de4(0x18a))/0x6+-parseInt(_0x4e5de4(0x19c))/0x7+-parseInt(_0x4e5de4(0x18c))/0x8+parseInt(_0x4e5de4(0x183))/0x9;if(_0xbc8073===_0xee7775)break;else _0x2dbd10['push'](_0x2dbd10['shift']());}catch(_0x3a8960){_0x2dbd10['push'](_0x2dbd10['shift']());}}}(a87_0x543f,0xb3ecd));Object[a87_0x916b81(0x18b)](exports,a87_0x916b81(0x181),{'value':!![]}),exports[a87_0x916b81(0x18e)]=void 0x0;const enc_1=require(a87_0x916b81(0x193)),mode_1=require(a87_0x916b81(0x19a)),Internal_1=require('../../Internal'),enc_2=require(a87_0x916b81(0x196)),generateIV=_0x4e0245=>{const _0x5f6f50=a87_0x916b81,_0x4b0117=new ArrayBuffer(0xc);return new DataView(_0x4b0117)[_0x5f6f50(0x198)](0x8,_0x4e0245),new Uint8Array(_0x4b0117);},makeNoiseHandler=({keyPair:{private:_0x169176,public:_0x46b659},NOISE_HEADER:_0x5c45af,mobile:_0x549192,logger:_0x1efab4,routingInfo:_0x5e0e1e})=>{const _0x20b256=a87_0x916b81,_0x528d3f=_0x445d04=>{const _0x2f24a6=a87_0x4a6e;!_0x473fa7&&(_0x3f0418=(0x0,enc_2[_0x2f24a6(0x186)])(Buffer['concat']([_0x3f0418,_0x445d04])));},_0x58e306=_0x6ab121=>{const _0x4fd474=a87_0x4a6e,_0x5c567a=(0x0,enc_2[_0x4fd474(0x19b)])(_0x6ab121,_0x3f8d01,generateIV(_0x3c7de3),_0x3f0418);return _0x3c7de3+=0x1,_0x528d3f(_0x5c567a),_0x5c567a;},_0x188861=_0x2d938f=>{const _0x138160=a87_0x4a6e,_0x40748a=generateIV(_0x473fa7?_0x11c18e:_0x3c7de3),_0x27fb61=(0x0,enc_2[_0x138160(0x1a2)])(_0x2d938f,_0x376979,_0x40748a,_0x3f0418);return _0x473fa7?_0x11c18e+=0x1:_0x3c7de3+=0x1,_0x528d3f(_0x2d938f),_0x27fb61;},_0x44cf8d=_0x4fb719=>{const _0x2c82c4=a87_0x4a6e,_0x2aa00f=(0x0,enc_2['hkdf'])(Buffer['from'](_0x4fb719),0x40,{'salt':_0x55f14a,'info':''});return[_0x2aa00f[_0x2c82c4(0x19e)](0x0,0x20),_0x2aa00f[_0x2c82c4(0x19e)](0x20)];},_0x5c3340=_0x3c6b5c=>{const [_0x5cfea2,_0x2fc9bf]=_0x44cf8d(_0x3c6b5c);_0x55f14a=_0x5cfea2,_0x3f8d01=_0x2fc9bf,_0x376979=_0x2fc9bf,_0x11c18e=0x0,_0x3c7de3=0x0;},_0xcebdeb=()=>{const [_0x498f32,_0x5e2d1d]=_0x44cf8d(new Uint8Array(0x0));_0x3f8d01=_0x498f32,_0x376979=_0x5e2d1d,_0x3f0418=Buffer['from']([]),_0x11c18e=0x0,_0x3c7de3=0x0,_0x473fa7=!![];},_0x23fdba=Buffer[_0x20b256(0x182)](mode_1[_0x20b256(0x1a1)]);let _0x3f0418=Buffer[_0x20b256(0x182)](_0x23fdba[_0x20b256(0x17c)]===0x20?_0x23fdba:(0x0,enc_2[_0x20b256(0x186)])(_0x23fdba)),_0x55f14a=_0x3f0418,_0x3f8d01=_0x3f0418,_0x376979=_0x3f0418,_0x11c18e=0x0,_0x3c7de3=0x0,_0x473fa7=![],_0x5520aa=![],_0x49b244=Buffer[_0x20b256(0x19f)](0x0);return _0x528d3f(_0x5c45af),_0x528d3f(_0x46b659),{'encrypt':_0x58e306,'decrypt':_0x188861,'authenticate':_0x528d3f,'mixIntoKey':_0x5c3340,'finishInit':_0xcebdeb,'processHandshake':({serverHello:_0x5a80bf},_0x5569f7)=>{const _0x555f15=_0x20b256;_0x528d3f(_0x5a80bf['ephemeral']),_0x5c3340(enc_2[_0x555f15(0x18f)]['sharedKey'](_0x169176,_0x5a80bf[_0x555f15(0x197)]));const _0x4d172f=_0x188861(_0x5a80bf['static']);_0x5c3340(enc_2[_0x555f15(0x18f)]['sharedKey'](_0x169176,_0x4d172f));const _0x4f147d=_0x188861(_0x5a80bf[_0x555f15(0x1a3)]);if(_0x549192)enc_1[_0x555f15(0x1a4)][_0x555f15(0x194)]['NoiseCertificate'][_0x555f15(0x191)](_0x4f147d);else{const {intermediate:_0x38ab2e}=enc_1[_0x555f15(0x1a4)]['CertChain'][_0x555f15(0x191)](_0x4f147d),{issuerSerial:_0x1aeaba}=enc_1[_0x555f15(0x1a4)][_0x555f15(0x194)]['NoiseCertificate']['Details']['decode'](_0x38ab2e['details']);if(_0x1aeaba!==mode_1[_0x555f15(0x17f)]['SERIAL'])throw null;}const _0x3f2ce8=_0x58e306(_0x5569f7['public']);return _0x5c3340(enc_2[_0x555f15(0x18f)][_0x555f15(0x189)](_0x5569f7[_0x555f15(0x188)],_0x5a80bf['ephemeral'])),_0x3f2ce8;},'encodeFrame':_0x117f87=>{const _0x488a88=_0x20b256;_0x473fa7&&(_0x117f87=_0x58e306(_0x117f87));let _0x8b2d51;_0x5e0e1e?(_0x8b2d51=Buffer['alloc'](0x7),_0x8b2d51[_0x488a88(0x199)]('ED',0x0,'utf8'),_0x8b2d51[_0x488a88(0x19d)](0x0,0x2),_0x8b2d51[_0x488a88(0x19d)](0x1,0x3),_0x8b2d51[_0x488a88(0x19d)](_0x5e0e1e[_0x488a88(0x17c)]>>0x10,0x4),_0x8b2d51[_0x488a88(0x1a0)](_0x5e0e1e[_0x488a88(0x17c)]&0xffff,0x5),_0x8b2d51=Buffer[_0x488a88(0x17e)]([_0x8b2d51,_0x5e0e1e,_0x5c45af])):_0x8b2d51=Buffer[_0x488a88(0x182)](_0x5c45af);const _0x276fe6=_0x5520aa?0x0:_0x8b2d51['length'],_0x22929a=Buffer[_0x488a88(0x19f)](_0x276fe6+0x3+_0x117f87[_0x488a88(0x17c)]);return!_0x5520aa&&(_0x22929a[_0x488a88(0x180)](_0x8b2d51),_0x5520aa=!![]),_0x22929a[_0x488a88(0x195)](_0x117f87['byteLength']>>0x10,_0x276fe6),_0x22929a['writeUInt16BE'](0xffff&_0x117f87['byteLength'],_0x276fe6+0x1),_0x22929a[_0x488a88(0x180)](_0x117f87,_0x276fe6+0x3),_0x22929a;},'decodeFrame':async(_0x5bf656,_0x30d929)=>{const _0x3a98cd=_0x20b256,_0x183d9f=()=>{const _0x17d2e7=a87_0x4a6e;if(_0x49b244['length']>=0x3)return _0x49b244['readUInt8']()<<0x10|_0x49b244[_0x17d2e7(0x17d)](0x1);};_0x49b244=Buffer[_0x3a98cd(0x17e)]([_0x49b244,_0x5bf656]);let _0x4ecba6=_0x183d9f();while(_0x4ecba6&&_0x49b244[_0x3a98cd(0x18d)]>=_0x4ecba6+0x3){let _0x17b7c7=_0x49b244[_0x3a98cd(0x19e)](0x3,_0x4ecba6+0x3);_0x49b244=_0x49b244[_0x3a98cd(0x19e)](_0x4ecba6+0x3);if(_0x473fa7){const _0x5dad77=_0x188861(_0x17b7c7);_0x17b7c7=await(0x0,Internal_1[_0x3a98cd(0x187)])(_0x5dad77);}_0x30d929(_0x17b7c7),_0x4ecba6=_0x183d9f();}}};};function a87_0x4a6e(_0x46966e,_0x293a27){const _0x543f85=a87_0x543f();return a87_0x4a6e=function(_0x4a6e7f,_0x1d32cd){_0x4a6e7f=_0x4a6e7f-0x17c;let _0xc342f2=_0x543f85[_0x4a6e7f];return _0xc342f2;},a87_0x4a6e(_0x46966e,_0x293a27);}exports['makeNoiseHandler']=makeNoiseHandler;function a87_0x543f(){const _0x2d4a6f=['writeUInt8','../crypto/enc','ephemeral','setUint32','write','../../Connection/mode','aesEncryptGCM','6048364GwQizZ','writeUint8','slice','alloc','writeUint16BE','NOISE_MODE','aesDecryptGCM','payload','proto','563097ZOWdRy','byteLength','readUInt16BE','concat','WA_CERT_DETAILS','set','__esModule','from','42053949hIpYAt','518985wFduLd','52RdFJls','sha256','decodeBinaryNode','private','sharedKey','5520648idboUE','defineProperty','2000352FGpbjJ','length','makeNoiseHandler','Curve','1078446zdoDZv','decode','14CVgXIf','../../Connection/enc','CertChain'];a87_0x543f=function(){return _0x2d4a6f;};return a87_0x543f();}