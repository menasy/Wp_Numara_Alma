'use strict';const a78_0x5f12bd=a78_0x453c;(function(_0x1658ee,_0x358ebc){const _0x4ae4d9=a78_0x453c,_0x5c5bb9=_0x1658ee();while(!![]){try{const _0x4d7d7e=parseInt(_0x4ae4d9(0x13d))/0x1*(-parseInt(_0x4ae4d9(0x15d))/0x2)+parseInt(_0x4ae4d9(0x176))/0x3*(parseInt(_0x4ae4d9(0x117))/0x4)+parseInt(_0x4ae4d9(0x133))/0x5+-parseInt(_0x4ae4d9(0x161))/0x6*(-parseInt(_0x4ae4d9(0x129))/0x7)+-parseInt(_0x4ae4d9(0x152))/0x8*(parseInt(_0x4ae4d9(0x157))/0x9)+-parseInt(_0x4ae4d9(0x119))/0xa*(parseInt(_0x4ae4d9(0x132))/0xb)+parseInt(_0x4ae4d9(0x13e))/0xc;if(_0x4d7d7e===_0x358ebc)break;else _0x5c5bb9['push'](_0x5c5bb9['shift']());}catch(_0x31e194){_0x5c5bb9['push'](_0x5c5bb9['shift']());}}}(a78_0x29fd,0xdb25a));Object['defineProperty'](exports,a78_0x5f12bd(0x177),{'value':!![]}),exports[a78_0x5f12bd(0x16e)]=exports['getChatId']=exports[a78_0x5f12bd(0x138)]=exports[a78_0x5f12bd(0x142)]=exports[a78_0x5f12bd(0x120)]=void 0x0;const enc_1=require(a78_0x5f12bd(0x14b)),Models_1=require(a78_0x5f12bd(0x125)),msg_1=require(a78_0x5f12bd(0x14a)),Internal_1=require('../../Internal'),enc_2=require(a78_0x5f12bd(0x170)),similary_1=require(a78_0x5f12bd(0x141)),history_1=require(a78_0x5f12bd(0x14e)),REAL_MSG_STUB_TYPES=new Set([Models_1[a78_0x5f12bd(0x150)][a78_0x5f12bd(0x121)],Models_1['WAMessageStubType'][a78_0x5f12bd(0x153)],Models_1[a78_0x5f12bd(0x150)][a78_0x5f12bd(0x12a)],Models_1['WAMessageStubType'][a78_0x5f12bd(0x146)]]),REAL_MSG_REQ_ME_STUB_TYPES=new Set([Models_1[a78_0x5f12bd(0x150)]['GROUP_PARTICIPANT_ADD']]),cleanMessage=(_0xec906a,_0x17c857)=>{const _0x2b4922=a78_0x5f12bd;_0xec906a['key'][_0x2b4922(0x139)]=(0x0,Internal_1[_0x2b4922(0x159)])(_0xec906a[_0x2b4922(0x15a)][_0x2b4922(0x139)]),_0xec906a[_0x2b4922(0x15a)][_0x2b4922(0x12f)]=_0xec906a['key']['participant']?(0x0,Internal_1[_0x2b4922(0x159)])(_0xec906a[_0x2b4922(0x15a)]['participant']):undefined;const _0x465b97=(0x0,msg_1[_0x2b4922(0x11d)])(_0xec906a[_0x2b4922(0x13c)]);(_0x465b97===null||_0x465b97===void 0x0?void 0x0:_0x465b97[_0x2b4922(0x11e)])&&_0x177054(_0x465b97[_0x2b4922(0x11e)][_0x2b4922(0x15a)]);(_0x465b97===null||_0x465b97===void 0x0?void 0x0:_0x465b97['pollUpdateMessage'])&&_0x177054(_0x465b97[_0x2b4922(0x15c)][_0x2b4922(0x14f)]);function _0x177054(_0x4feac5){const _0x2664c9=_0x2b4922;!_0xec906a[_0x2664c9(0x15a)][_0x2664c9(0x148)]&&(_0x4feac5[_0x2664c9(0x148)]=!_0x4feac5[_0x2664c9(0x148)]?(0x0,Internal_1['areJidsSameUser'])(_0x4feac5[_0x2664c9(0x12f)]||_0x4feac5[_0x2664c9(0x139)],_0x17c857):![],_0x4feac5['remoteJid']=_0xec906a['key'][_0x2664c9(0x139)],_0x4feac5['participant']=_0x4feac5[_0x2664c9(0x12f)]||_0xec906a[_0x2664c9(0x15a)]['participant']);}};exports['cleanMessage']=cleanMessage;const isRealMessage=(_0x3a3cb5,_0x168916)=>{const _0x233f36=a78_0x5f12bd;var _0x565872;const _0x5f18e1=(0x0,msg_1[_0x233f36(0x11d)])(_0x3a3cb5[_0x233f36(0x13c)]),_0x14499d=!!(0x0,msg_1[_0x233f36(0x128)])(_0x5f18e1);return(!!_0x5f18e1||REAL_MSG_STUB_TYPES[_0x233f36(0x14d)](_0x3a3cb5['messageStubType'])||REAL_MSG_REQ_ME_STUB_TYPES[_0x233f36(0x14d)](_0x3a3cb5[_0x233f36(0x13f)])&&((_0x565872=_0x3a3cb5[_0x233f36(0x160)])===null||_0x565872===void 0x0?void 0x0:_0x565872[_0x233f36(0x118)](_0x4d4aa7=>(0x0,Internal_1[_0x233f36(0x12b)])(_0x168916,_0x4d4aa7))))&&_0x14499d&&!(_0x5f18e1===null||_0x5f18e1===void 0x0?void 0x0:_0x5f18e1[_0x233f36(0x137)])&&!(_0x5f18e1===null||_0x5f18e1===void 0x0?void 0x0:_0x5f18e1[_0x233f36(0x11e)])&&!(_0x5f18e1===null||_0x5f18e1===void 0x0?void 0x0:_0x5f18e1[_0x233f36(0x15c)]);};exports[a78_0x5f12bd(0x142)]=isRealMessage;function a78_0x29fd(){const _0xe13483=['../crypto/enc','getChatId','GROUP_CHANGE_INVITE_LINK','Type','ProtocolMessage','messages.update','30HmsXKR','__esModule','type','271332lREEXl','some','9617050vDEqZH','REVOKE','messages.reaction','processedHistoryMessages','normalizeMessageContent','reactionMessage','conversationTimestamp','cleanMessage','CALL_MISSED_GROUP_VIDEO','GROUP_PARTICIPANT_LEAVE','GROUP_PARTICIPANT_REMOVE','getKeyAuthor','../../Models','appStateSyncKeyShare','creds.update','getContentType','10584wyqcSP','CALL_MISSED_VIDEO','areJidsSameUser','APP_STATE_SYNC_KEY_SHARE','length','group-participants.update','participant','assign','Message','11FYFPTG','4136525vRXRTV','add','decode','readOnly','protocolMessage','shouldIncrementChatUnread','remoteJid','push','transaction','message','880405CfARgn','18006660FjxjoV','messageStubType','vote','../crypto/similary','isRealMessage','emit','GROUP_PARTICIPANT_INVITE','sha256','CALL_MISSED_VOICE','from','fromMe','messaging-history.set','./msg','../../Connection/enc','aesDecryptGCM','has','./history','pollCreationMessageKey','WAMessageStubType','GROUP_CHANGE_RESTRICT','132536jpfwxF','CALL_MISSED_GROUP_VOICE','name','EPHEMERAL_SETTING','HISTORY_SYNC_NOTIFICATION','162McWCoJ','historySyncNotification','jidNormalizedUser','key','GROUP_CHANGE_SUBJECT','pollUpdateMessage','2LKAaVX','set','messageContextInfo','messageStubParameters','126TZVdIA','GROUP_CHANGE_ANNOUNCE','PollVoteMessage','ephemeralExpiration','unarchiveChats','keys','GROUP_PARTICIPANT_ADD_REQUEST_JOIN','proto','unreadCount','toNumber','archived','true','GROUP_PARTICIPANT_PROMOTE','decryptPollVote','messageTimestamp'];a78_0x29fd=function(){return _0xe13483;};return a78_0x29fd();}const shouldIncrementChatUnread=_0x1c21e7=>!_0x1c21e7[a78_0x5f12bd(0x15a)]['fromMe']&&!_0x1c21e7[a78_0x5f12bd(0x13f)];exports[a78_0x5f12bd(0x138)]=shouldIncrementChatUnread;const getChatId=({remoteJid:_0x5144b5,participant:_0x29bba1,fromMe:_0x4e4a0b})=>{if((0x0,Internal_1['isJidBroadcast'])(_0x5144b5)&&!(0x0,Internal_1['isJidStatusBroadcast'])(_0x5144b5)&&!_0x4e4a0b)return _0x29bba1;return _0x5144b5;};exports[a78_0x5f12bd(0x171)]=getChatId;function a78_0x453c(_0x2181af,_0x308284){const _0x29fdbe=a78_0x29fd();return a78_0x453c=function(_0x453cf6,_0x413425){_0x453cf6=_0x453cf6-0x116;let _0x16a585=_0x29fdbe[_0x453cf6];return _0x16a585;},a78_0x453c(_0x2181af,_0x308284);}function decryptPollVote({encPayload:_0x30869b,encIv:_0x386d54},{pollCreatorJid:_0x294f57,pollMsgId:_0x35e353,pollEncKey:_0x3595f2,voterJid:_0x33efa5}){const _0xc17c41=a78_0x5f12bd,_0x5b6b02=Buffer['concat']([_0x1eb29f(_0x35e353),_0x1eb29f(_0x294f57),_0x1eb29f(_0x33efa5),_0x1eb29f('Poll\x20Vote'),new Uint8Array([0x1])]),_0x18a47d=(0x0,enc_2['hmacSign'])(_0x3595f2,new Uint8Array(0x20),'sha256'),_0x3c119d=(0x0,enc_2['hmacSign'])(_0x5b6b02,_0x18a47d,_0xc17c41(0x145)),_0xa5689c=_0x1eb29f(_0x35e353+'\x00'+_0x33efa5),_0x4ba859=(0x0,enc_2[_0xc17c41(0x14c)])(_0x30869b,_0x3c119d,_0x386d54,_0xa5689c);return enc_1[_0xc17c41(0x168)]['Message'][_0xc17c41(0x163)][_0xc17c41(0x135)](_0x4ba859);function _0x1eb29f(_0x2646c){const _0x2ee9c4=_0xc17c41;return Buffer[_0x2ee9c4(0x147)](_0x2646c);}}exports[a78_0x5f12bd(0x16e)]=decryptPollVote;const processMessage=async(_0x248fa5,{shouldProcessHistoryMsg:_0x2da4bd,ev:_0x29c93c,creds:_0x14d5e0,keyStore:_0x2dcc00,logger:_0x3d12d2,options:_0x16748d,getMessage:_0x53faf3})=>{const _0xe76e04=a78_0x5f12bd;var _0x35fec5,_0x1d4d35,_0x58e90c,_0x40e7fa,_0x2a8401,_0x52e06e,_0x4ae6cf,_0xd03bb8;const _0x4ef743=_0x14d5e0['me']['id'],{accountSettings:_0x3e90a6}=_0x14d5e0,_0x411fd1={'id':(0x0,Internal_1[_0xe76e04(0x159)])((0x0,exports[_0xe76e04(0x171)])(_0x248fa5[_0xe76e04(0x15a)]))},_0x209550=(0x0,exports[_0xe76e04(0x142)])(_0x248fa5,_0x4ef743);_0x209550&&(_0x411fd1[_0xe76e04(0x11f)]=(0x0,similary_1[_0xe76e04(0x16a)])(_0x248fa5[_0xe76e04(0x16f)]),(0x0,exports[_0xe76e04(0x138)])(_0x248fa5)&&(_0x411fd1['unreadCount']=(_0x411fd1[_0xe76e04(0x169)]||0x0)+0x1));const _0x4ece55=(0x0,msg_1['normalizeMessageContent'])(_0x248fa5[_0xe76e04(0x13c)]);(_0x209550||((_0x1d4d35=(_0x35fec5=_0x4ece55===null||_0x4ece55===void 0x0?void 0x0:_0x4ece55[_0xe76e04(0x11e)])===null||_0x35fec5===void 0x0?void 0x0:_0x35fec5[_0xe76e04(0x15a)])===null||_0x1d4d35===void 0x0?void 0x0:_0x1d4d35[_0xe76e04(0x148)]))&&(_0x3e90a6===null||_0x3e90a6===void 0x0?void 0x0:_0x3e90a6[_0xe76e04(0x165)])&&(_0x411fd1[_0xe76e04(0x16b)]=![],_0x411fd1['readOnly']=![]);const _0x14e9be=_0x4ece55===null||_0x4ece55===void 0x0?void 0x0:_0x4ece55[_0xe76e04(0x137)];if(_0x14e9be)switch(_0x14e9be[_0xe76e04(0x116)]){case enc_1[_0xe76e04(0x168)][_0xe76e04(0x131)][_0xe76e04(0x174)][_0xe76e04(0x173)][_0xe76e04(0x156)]:const _0x2b2259=_0x14e9be[_0xe76e04(0x158)],_0x4e5e0d=_0x2da4bd,_0x108325=!((_0x58e90c=_0x14d5e0[_0xe76e04(0x11c)])===null||_0x58e90c===void 0x0?void 0x0:_0x58e90c[_0xe76e04(0x12d)]);if(_0x4e5e0d){_0x29c93c['emit'](_0xe76e04(0x127),{'processedHistoryMessages':[..._0x14d5e0[_0xe76e04(0x11c)]||[],{'key':_0x248fa5[_0xe76e04(0x15a)],'messageTimestamp':_0x248fa5[_0xe76e04(0x16f)]}]});const _0x128912=await(0x0,history_1['downloadAndProcessHistorySyncNotification'])(_0x2b2259,_0x16748d,_0x29c93c);_0x29c93c[_0xe76e04(0x143)](_0xe76e04(0x149),{..._0x128912,'isLatest':_0x108325});}break;case enc_1[_0xe76e04(0x168)][_0xe76e04(0x131)]['ProtocolMessage'][_0xe76e04(0x173)][_0xe76e04(0x12c)]:const _0x34f0d1=_0x14e9be[_0xe76e04(0x126)]['keys'];if(_0x34f0d1===null||_0x34f0d1===void 0x0?void 0x0:_0x34f0d1['length']){let _0xd67473='';await _0x2dcc00[_0xe76e04(0x13b)](async()=>{const _0x1c5016=_0xe76e04,_0x3fb8c2=[];for(const {keyData:_0x491cc0,keyId:_0x41ff56}of _0x34f0d1){const _0x15f975=Buffer['from'](_0x41ff56['keyId'])['toString']('base64');_0x3fb8c2[_0x1c5016(0x13a)](_0x15f975),await _0x2dcc00[_0x1c5016(0x15e)]({'app-state-sync-key':{[_0x15f975]:_0x491cc0}}),_0xd67473=_0x15f975;}}),_0x29c93c[_0xe76e04(0x143)](_0xe76e04(0x127),{'myAppStateKeyId':_0xd67473});}else{}break;case enc_1[_0xe76e04(0x168)][_0xe76e04(0x131)]['ProtocolMessage']['Type'][_0xe76e04(0x11a)]:_0x29c93c[_0xe76e04(0x143)](_0xe76e04(0x175),[{'key':{..._0x248fa5[_0xe76e04(0x15a)],'id':_0x14e9be[_0xe76e04(0x15a)]['id']},'update':{'message':null,'messageStubType':Models_1[_0xe76e04(0x150)][_0xe76e04(0x11a)],'key':_0x248fa5['key']}}]);break;case enc_1[_0xe76e04(0x168)][_0xe76e04(0x131)][_0xe76e04(0x174)][_0xe76e04(0x173)][_0xe76e04(0x155)]:Object[_0xe76e04(0x130)](_0x411fd1,{'ephemeralSettingTimestamp':(0x0,similary_1[_0xe76e04(0x16a)])(_0x248fa5[_0xe76e04(0x16f)]),'ephemeralExpiration':_0x14e9be[_0xe76e04(0x164)]||null});break;}else{if(_0x4ece55===null||_0x4ece55===void 0x0?void 0x0:_0x4ece55['reactionMessage']){const _0x71382d={..._0x4ece55['reactionMessage'],'key':_0x248fa5[_0xe76e04(0x15a)]};_0x29c93c[_0xe76e04(0x143)](_0xe76e04(0x11b),[{'reaction':_0x71382d,'key':_0x4ece55[_0xe76e04(0x11e)][_0xe76e04(0x15a)]}]);}else{if(_0x248fa5[_0xe76e04(0x13f)]){const _0x4ebf2d=_0x248fa5[_0xe76e04(0x15a)][_0xe76e04(0x139)];let _0x1a91d9;const _0x3b7abc=_0x16d91c=>_0x29c93c[_0xe76e04(0x143)](_0xe76e04(0x12e),{'id':_0x4ebf2d,'participants':_0x1a91d9,'action':_0x16d91c}),_0x38fcf9=_0x20f8f7=>{const _0x4ad6d8=_0xe76e04;var _0x26a1da;_0x29c93c[_0x4ad6d8(0x143)]('groups.update',[{'id':_0x4ebf2d,..._0x20f8f7,'author':(_0x26a1da=_0x248fa5[_0x4ad6d8(0x12f)])!==null&&_0x26a1da!==void 0x0?_0x26a1da:undefined}]);},_0x1f3b42=()=>_0x1a91d9['find'](_0x8691f5=>(0x0,Internal_1['areJidsSameUser'])(_0x4ef743,_0x8691f5));switch(_0x248fa5[_0xe76e04(0x13f)]){case Models_1['WAMessageStubType'][_0xe76e04(0x122)]:case Models_1['WAMessageStubType'][_0xe76e04(0x123)]:_0x1a91d9=_0x248fa5[_0xe76e04(0x160)]||[],_0x3b7abc('remove');_0x1f3b42()&&(_0x411fd1[_0xe76e04(0x136)]=!![]);break;case Models_1['WAMessageStubType']['GROUP_PARTICIPANT_ADD']:case Models_1[_0xe76e04(0x150)][_0xe76e04(0x144)]:case Models_1['WAMessageStubType'][_0xe76e04(0x167)]:_0x1a91d9=_0x248fa5['messageStubParameters']||[];_0x1f3b42()&&(_0x411fd1[_0xe76e04(0x136)]=![]);_0x3b7abc(_0xe76e04(0x134));break;case Models_1[_0xe76e04(0x150)]['GROUP_PARTICIPANT_DEMOTE']:_0x1a91d9=_0x248fa5[_0xe76e04(0x160)]||[],_0x3b7abc('demote');break;case Models_1[_0xe76e04(0x150)][_0xe76e04(0x16d)]:_0x1a91d9=_0x248fa5[_0xe76e04(0x160)]||[],_0x3b7abc('promote');break;case Models_1[_0xe76e04(0x150)][_0xe76e04(0x162)]:const _0x3cdbd0=(_0x40e7fa=_0x248fa5[_0xe76e04(0x160)])===null||_0x40e7fa===void 0x0?void 0x0:_0x40e7fa[0x0];_0x38fcf9({'announce':_0x3cdbd0===_0xe76e04(0x16c)||_0x3cdbd0==='on'});break;case Models_1['WAMessageStubType'][_0xe76e04(0x151)]:const _0x3fa1fe=(_0x2a8401=_0x248fa5[_0xe76e04(0x160)])===null||_0x2a8401===void 0x0?void 0x0:_0x2a8401[0x0];_0x38fcf9({'restrict':_0x3fa1fe==='true'||_0x3fa1fe==='on'});break;case Models_1['WAMessageStubType'][_0xe76e04(0x15b)]:const _0x2b5700=(_0x52e06e=_0x248fa5[_0xe76e04(0x160)])===null||_0x52e06e===void 0x0?void 0x0:_0x52e06e[0x0];_0x411fd1[_0xe76e04(0x154)]=_0x2b5700,_0x38fcf9({'subject':_0x2b5700});break;case Models_1[_0xe76e04(0x150)][_0xe76e04(0x172)]:const _0x2bb2f7=(_0x4ae6cf=_0x248fa5[_0xe76e04(0x160)])===null||_0x4ae6cf===void 0x0?void 0x0:_0x4ae6cf[0x0];_0x38fcf9({'inviteCode':_0x2bb2f7});break;}}else{if(_0x4ece55===null||_0x4ece55===void 0x0?void 0x0:_0x4ece55['pollUpdateMessage']){const _0x460e74=_0x4ece55['pollUpdateMessage'][_0xe76e04(0x14f)],_0x5d0a68=await _0x53faf3(_0x460e74);if(_0x5d0a68){const _0x30fe71=(0x0,Internal_1['jidNormalizedUser'])(_0x4ef743),_0x56ba1c=(0x0,similary_1[_0xe76e04(0x124)])(_0x460e74,_0x30fe71),_0x226df4=(0x0,similary_1[_0xe76e04(0x124)])(_0x248fa5[_0xe76e04(0x15a)],_0x30fe71),_0x5973f0=(_0xd03bb8=_0x5d0a68[_0xe76e04(0x15f)])===null||_0xd03bb8===void 0x0?void 0x0:_0xd03bb8['messageSecret'];try{const _0x1e3034=decryptPollVote(_0x4ece55['pollUpdateMessage'][_0xe76e04(0x140)],{'pollEncKey':_0x5973f0,'pollCreatorJid':_0x56ba1c,'pollMsgId':_0x460e74['id'],'voterJid':_0x226df4});_0x29c93c[_0xe76e04(0x143)](_0xe76e04(0x175),[{'key':_0x460e74,'update':{'pollUpdates':[{'pollUpdateMessageKey':_0x248fa5[_0xe76e04(0x15a)],'vote':_0x1e3034,'senderTimestampMs':_0x248fa5[_0xe76e04(0x16f)]}]}}]);}catch(_0x5500fb){}}else{}}}}}Object[_0xe76e04(0x166)](_0x411fd1)['length']>0x1&&_0x29c93c[_0xe76e04(0x143)]('chats.update',[_0x411fd1]);};exports['default']=processMessage;