'use strict';const a81_0x36cca7=a81_0xab0f;(function(_0x1db75d,_0x5ad939){const _0x61dba8=a81_0xab0f,_0x40ec45=_0x1db75d();while(!![]){try{const _0x19679a=-parseInt(_0x61dba8(0x134))/0x1+parseInt(_0x61dba8(0x18c))/0x2+parseInt(_0x61dba8(0x106))/0x3+-parseInt(_0x61dba8(0x131))/0x4+parseInt(_0x61dba8(0x168))/0x5*(-parseInt(_0x61dba8(0x185))/0x6)+-parseInt(_0x61dba8(0x125))/0x7*(parseInt(_0x61dba8(0x19b))/0x8)+parseInt(_0x61dba8(0x10e))/0x9;if(_0x19679a===_0x5ad939)break;else _0x40ec45['push'](_0x40ec45['shift']());}catch(_0x31d1e1){_0x40ec45['push'](_0x40ec45['shift']());}}}(a81_0x5a59,0x4727c));var __createBinding=this&&this[a81_0x36cca7(0x14a)]||(Object[a81_0x36cca7(0x1a0)]?function(_0x510133,_0x4b7d4b,_0x436d41,_0x2aa608){const _0x5b252f=a81_0x36cca7;if(_0x2aa608===undefined)_0x2aa608=_0x436d41;var _0x2828e4=Object[_0x5b252f(0xef)](_0x4b7d4b,_0x436d41);(!_0x2828e4||(_0x5b252f(0x151)in _0x2828e4?!_0x4b7d4b[_0x5b252f(0x133)]:_0x2828e4[_0x5b252f(0x16b)]||_0x2828e4['configurable']))&&(_0x2828e4={'enumerable':!![],'get':function(){return _0x4b7d4b[_0x436d41];}}),Object['defineProperty'](_0x510133,_0x2aa608,_0x2828e4);}:function(_0x45dcc6,_0x30540b,_0x211683,_0x479d92){if(_0x479d92===undefined)_0x479d92=_0x211683;_0x45dcc6[_0x479d92]=_0x30540b[_0x211683];}),__setModuleDefault=this&&this[a81_0x36cca7(0x141)]||(Object[a81_0x36cca7(0x1a0)]?function(_0xdd985b,_0x32fd09){const _0x45549a=a81_0x36cca7;Object[_0x45549a(0x18e)](_0xdd985b,'default',{'enumerable':!![],'value':_0x32fd09});}:function(_0x8853d3,_0x54acf1){_0x8853d3['default']=_0x54acf1;}),__importStar=this&&this['__importStar']||function(_0x38422d){const _0x4c5b8b=a81_0x36cca7;if(_0x38422d&&_0x38422d[_0x4c5b8b(0x133)])return _0x38422d;var _0x55b390={};if(_0x38422d!=null){for(var _0x31a84f in _0x38422d)if(_0x31a84f!=='default'&&Object[_0x4c5b8b(0xee)][_0x4c5b8b(0xe8)][_0x4c5b8b(0x111)](_0x38422d,_0x31a84f))__createBinding(_0x55b390,_0x38422d,_0x31a84f);}return __setModuleDefault(_0x55b390,_0x38422d),_0x55b390;};Object[a81_0x36cca7(0x18e)](exports,a81_0x36cca7(0x133),{'value':!![]}),exports[a81_0x36cca7(0x18a)]=exports[a81_0x36cca7(0x14d)]=exports[a81_0x36cca7(0x113)]=exports[a81_0x36cca7(0x15b)]=exports[a81_0x36cca7(0x15a)]=exports[a81_0x36cca7(0x11c)]=exports[a81_0x36cca7(0x10c)]=exports['downloadContentFromMessage']=exports[a81_0x36cca7(0xf8)]=exports['encryptedStream']=exports[a81_0x36cca7(0x189)]=exports['generateThumbnail']=exports[a81_0x36cca7(0x15e)]=exports[a81_0x36cca7(0x121)]=exports[a81_0x36cca7(0x115)]=exports[a81_0x36cca7(0x154)]=exports[a81_0x36cca7(0x177)]=exports[a81_0x36cca7(0x104)]=exports[a81_0x36cca7(0xf6)]=exports[a81_0x36cca7(0x15f)]=exports[a81_0x36cca7(0x197)]=exports[a81_0x36cca7(0x17b)]=exports[a81_0x36cca7(0x144)]=void 0x0;const child_process_1=require(a81_0x36cca7(0x172)),Crypto=__importStar(require('crypto')),events_1=require(a81_0x36cca7(0x182)),fs_1=require('fs'),os_1=require('os'),path_1=require(a81_0x36cca7(0x198)),stream_1=require(a81_0x36cca7(0x18d)),enc_1=require('../../Connection/enc'),mode_1=require(a81_0x36cca7(0x186)),Internal_1=require('../../Internal'),enc_2=require(a81_0x36cca7(0x191)),similary_1=require(a81_0x36cca7(0x117)),getTmpFilesDirectory=()=>(0x0,os_1[a81_0x36cca7(0x19e)])(),getImageProcessingLibrary=async()=>{const _0x3bbb87=a81_0x36cca7,[_0x4e119b,_0x18001a]=await Promise[_0x3bbb87(0x126)]([((async()=>{const _0x2497e1=_0x3bbb87,_0x37ea4d=await Promise[_0x2497e1(0x127)]()[_0x2497e1(0x142)](()=>__importStar(require(_0x2497e1(0x13b))))[_0x2497e1(0x11b)](()=>{});return _0x37ea4d;})()),((async()=>{const _0x1d4af4=_0x3bbb87,_0x14f329=await Promise[_0x1d4af4(0x127)]()['then'](()=>__importStar(require(_0x1d4af4(0x180))))['catch'](()=>{});return _0x14f329;})())]);if(_0x18001a)return{'sharp':_0x18001a};const _0x2f9c77=(_0x4e119b===null||_0x4e119b===void 0x0?void 0x0:_0x4e119b[_0x3bbb87(0x16d)])||_0x4e119b;if(_0x2f9c77)return{'jimp':_0x2f9c77};throw _0x3bbb87(0xf9);},hkdfInfoKey=_0x8c0e6f=>{const _0x4666b2=a81_0x36cca7,_0x329f37=mode_1[_0x4666b2(0x159)][_0x8c0e6f];return _0x4666b2(0x156)+_0x329f37+'\x20Keys';};exports[a81_0x36cca7(0x144)]=hkdfInfoKey;function getMediaKeys(_0x3f9022,_0x15ae23){const _0x1986dc=a81_0x36cca7;if(!_0x3f9022)throw _0x1986dc(0x107);typeof _0x3f9022==='string'&&(_0x3f9022=Buffer['from'](_0x3f9022[_0x1986dc(0x147)](_0x1986dc(0x137),''),'base64'));const _0x4be98c=(0x0,enc_2[_0x1986dc(0x19c)])(_0x3f9022,0x70,{'info':(0x0,exports['hkdfInfoKey'])(_0x15ae23)});return{'iv':_0x4be98c[_0x1986dc(0x12e)](0x0,0x10),'cipherKey':_0x4be98c[_0x1986dc(0x12e)](0x10,0x30),'macKey':_0x4be98c['slice'](0x30,0x50)};}exports['getMediaKeys']=getMediaKeys;const extractVideoThumb=async(_0x127c94,_0x34e18a,_0x20da9c,_0x5b76a2)=>new Promise((_0x2b21ea,_0x227e44)=>{const _0x155974=a81_0x36cca7,_0x2a47e9=_0x155974(0x138)+_0x20da9c+'\x20-i\x20'+_0x127c94+'\x20-y\x20-vf\x20scale='+_0x5b76a2[_0x155974(0x11d)]+':-1\x20-vframes\x201\x20-f\x20image2\x20'+_0x34e18a;(0x0,child_process_1['exec'])(_0x2a47e9,_0x492cb4=>{_0x492cb4?_0x227e44(_0x492cb4):_0x2b21ea();});}),extractImageThumb=async(_0x466dbb,_0x936171=0x20)=>{const _0x11f055=a81_0x36cca7;var _0x1d97bb,_0x1907dc;_0x466dbb instanceof stream_1[_0x11f055(0xf1)]&&(_0x466dbb=await(0x0,exports[_0x11f055(0x121)])(_0x466dbb));const _0x23a632=await getImageProcessingLibrary();if(_0x11f055(0x180)in _0x23a632&&typeof((_0x1d97bb=_0x23a632[_0x11f055(0x180)])===null||_0x1d97bb===void 0x0?void 0x0:_0x1d97bb[_0x11f055(0x16d)])===_0x11f055(0x160)){const _0x2a2799=_0x23a632['sharp'][_0x11f055(0x16d)](_0x466dbb),_0x1e98a9=await _0x2a2799[_0x11f055(0xff)](),_0x2cbd5e=await _0x2a2799[_0x11f055(0x161)](_0x936171)['jpeg']({'quality':0x32})[_0x11f055(0x121)]();return{'buffer':_0x2cbd5e,'original':{'width':_0x1e98a9[_0x11f055(0x11d)],'height':_0x1e98a9[_0x11f055(0x129)]}};}else{if(_0x11f055(0x13b)in _0x23a632&&typeof((_0x1907dc=_0x23a632[_0x11f055(0x13b)])===null||_0x1907dc===void 0x0?void 0x0:_0x1907dc['read'])===_0x11f055(0x160)){const {read:_0x5ab2b3,MIME_JPEG:_0x142c93,RESIZE_BILINEAR:_0x226ca0,AUTO:_0x58389e}=_0x23a632[_0x11f055(0x13b)],_0x1b3523=await _0x5ab2b3(_0x466dbb),_0x22348a={'width':_0x1b3523[_0x11f055(0x165)](),'height':_0x1b3523[_0x11f055(0x18f)]()},_0x5d1a1d=await _0x1b3523['quality'](0x32)[_0x11f055(0x161)](_0x936171,_0x58389e,_0x226ca0)[_0x11f055(0x124)](_0x142c93);return{'buffer':_0x5d1a1d,'original':_0x22348a};}else throw'erro\x20tamanho\x20da\x20midia';}};exports[a81_0x36cca7(0x197)]=extractImageThumb;const encodeBase64EncodedStringForUpload=_0x42357a=>encodeURIComponent(_0x42357a['replace'](/\+/g,'-')['replace'](/\//g,'_')['replace'](/\=+$/,''));exports[a81_0x36cca7(0x15f)]=encodeBase64EncodedStringForUpload;const generateProfilePicture=async _0x49c591=>{const _0x3a7c21=a81_0x36cca7;var _0x34eeef,_0x1673eb;let _0x51e919;if(Buffer['isBuffer'](_0x49c591))_0x51e919=_0x49c591;else'url'in _0x49c591?_0x51e919=_0x49c591[_0x3a7c21(0x13d)][_0x3a7c21(0xfe)]():_0x51e919=await(0x0,exports[_0x3a7c21(0x121)])(_0x49c591[_0x3a7c21(0x18d)]);const _0x59f01a=await getImageProcessingLibrary();let _0x3b5bd5;if(_0x3a7c21(0x180)in _0x59f01a&&typeof((_0x34eeef=_0x59f01a['sharp'])===null||_0x34eeef===void 0x0?void 0x0:_0x34eeef[_0x3a7c21(0x16d)])===_0x3a7c21(0x160))_0x3b5bd5=_0x59f01a[_0x3a7c21(0x180)]['default'](_0x51e919)[_0x3a7c21(0x161)](0x280,0x280)[_0x3a7c21(0x19f)]({'quality':0x32})['toBuffer']();else{if(_0x3a7c21(0x13b)in _0x59f01a&&typeof((_0x1673eb=_0x59f01a['jimp'])===null||_0x1673eb===void 0x0?void 0x0:_0x1673eb[_0x3a7c21(0x12d)])===_0x3a7c21(0x160)){const {read:_0x76dada,MIME_JPEG:_0x90b939,RESIZE_BILINEAR:_0x15f112}=_0x59f01a[_0x3a7c21(0x13b)],_0x3a445d=await _0x76dada(_0x51e919),_0x1e6ba6=Math['min'](_0x3a445d[_0x3a7c21(0x165)](),_0x3a445d[_0x3a7c21(0x18f)]()),_0x376088=_0x3a445d[_0x3a7c21(0x128)](0x0,0x0,_0x1e6ba6,_0x1e6ba6);_0x3b5bd5=_0x376088['quality'](0x32)[_0x3a7c21(0x161)](0x280,0x280,_0x15f112)[_0x3a7c21(0x124)](_0x90b939);}else throw _0x3a7c21(0x17c);}return{'img':await _0x3b5bd5};};exports[a81_0x36cca7(0xf6)]=generateProfilePicture;const mediaMessageSHA256B64=_0x27115c=>{const _0x306aca=a81_0x36cca7,_0x26b519=Object['values'](_0x27115c)[0x0];return(_0x26b519===null||_0x26b519===void 0x0?void 0x0:_0x26b519[_0x306aca(0x145)])&&Buffer['from'](_0x26b519[_0x306aca(0x145)])[_0x306aca(0xfe)](_0x306aca(0x13e));};exports[a81_0x36cca7(0x104)]=mediaMessageSHA256B64;async function getAudioDuration(_0x337a65){const _0x14e2e2=a81_0x36cca7,_0x26af4a=await Promise['resolve']()['then'](()=>__importStar(require(_0x14e2e2(0x174))));let _0x258ac7;if(Buffer[_0x14e2e2(0x10a)](_0x337a65))_0x258ac7=await _0x26af4a[_0x14e2e2(0x102)](_0x337a65,undefined,{'duration':!![]});else{if(typeof _0x337a65===_0x14e2e2(0x17a)){const _0x290c1d=(0x0,fs_1[_0x14e2e2(0x10f)])(_0x337a65);try{_0x258ac7=await _0x26af4a[_0x14e2e2(0x119)](_0x290c1d,undefined,{'duration':!![]});}finally{_0x290c1d[_0x14e2e2(0x11e)]();}}else _0x258ac7=await _0x26af4a['parseStream'](_0x337a65,undefined,{'duration':!![]});}return _0x258ac7[_0x14e2e2(0x122)][_0x14e2e2(0x103)];}exports[a81_0x36cca7(0x177)]=getAudioDuration;async function getAudioWaveform(_0xa967e6,_0x54102a){const _0x383ce7=a81_0x36cca7;try{const _0x4fee21=_0xc9422f=>Promise[_0x383ce7(0x127)]()['then'](()=>__importStar(require(_0x383ce7(0xfd))))[_0x383ce7(0x142)](({default:_0xde2bd1})=>_0xde2bd1(_0xc9422f));let _0x4ac943;if(Buffer['isBuffer'](_0xa967e6))_0x4ac943=_0xa967e6;else{if(typeof _0xa967e6==='string'){const _0x2a387f=(0x0,fs_1[_0x383ce7(0x10f)])(_0xa967e6);_0x4ac943=await(0x0,exports[_0x383ce7(0x121)])(_0x2a387f);}else _0x4ac943=await(0x0,exports[_0x383ce7(0x121)])(_0xa967e6);}const _0x31a0d8=await _0x4fee21(_0x4ac943),_0x2a5261=_0x31a0d8[_0x383ce7(0x118)](0x0),_0x59464c=0x40,_0x4f425d=Math['floor'](_0x2a5261[_0x383ce7(0x162)]/_0x59464c),_0x4ac11e=[];for(let _0x2d2d29=0x0;_0x2d2d29<_0x59464c;_0x2d2d29++){const _0x49e60b=_0x4f425d*_0x2d2d29;let _0xfc9fae=0x0;for(let _0x3702df=0x0;_0x3702df<_0x4f425d;_0x3702df++){_0xfc9fae=_0xfc9fae+Math[_0x383ce7(0xf3)](_0x2a5261[_0x49e60b+_0x3702df]);}_0x4ac11e['push'](_0xfc9fae/_0x4f425d);}const _0x44420f=Math[_0x383ce7(0x176)](Math[_0x383ce7(0x143)](..._0x4ac11e),-0x1),_0x4f7bc0=_0x4ac11e['map'](_0x364e36=>_0x364e36*_0x44420f),_0x3d9534=new Uint8Array(_0x4f7bc0[_0x383ce7(0x100)](_0x2fd4aa=>Math[_0x383ce7(0x188)](0x64*_0x2fd4aa)));return _0x3d9534;}catch(_0x5bf45d){}}exports[a81_0x36cca7(0x154)]=getAudioWaveform;const toReadable=_0x6604eb=>{const _0x3136a7=a81_0x36cca7,_0x104121=new stream_1[(_0x3136a7(0xf1))]({'read':()=>{}});return _0x104121[_0x3136a7(0x173)](_0x6604eb),_0x104121[_0x3136a7(0x173)](null),_0x104121;};exports[a81_0x36cca7(0x115)]=toReadable;const toBuffer=async _0x44c0ad=>{const _0x360122=a81_0x36cca7,_0x51afe3=[];for await(const _0x530116 of _0x44c0ad){_0x51afe3[_0x360122(0x173)](_0x530116);}return _0x44c0ad[_0x360122(0x11e)](),Buffer[_0x360122(0x17f)](_0x51afe3);};exports['toBuffer']=toBuffer;const getStream=async(_0x581059,_0x49d283)=>{const _0x1feeb4=a81_0x36cca7;if(Buffer[_0x1feeb4(0x10a)](_0x581059))return{'stream':(0x0,exports[_0x1feeb4(0x115)])(_0x581059),'type':'buffer'};if(_0x1feeb4(0x18d)in _0x581059)return{'stream':_0x581059[_0x1feeb4(0x18d)],'type':_0x1feeb4(0x14c)};if(_0x581059['url'][_0x1feeb4(0xfe)]()['startsWith'](_0x1feeb4(0x15d))||_0x581059['url'][_0x1feeb4(0xfe)]()[_0x1feeb4(0x10b)](_0x1feeb4(0x152)))return{'stream':await(0x0,exports['getHttpStream'])(_0x581059[_0x1feeb4(0x13d)],_0x49d283),'type':_0x1feeb4(0xf0)};return{'stream':(0x0,fs_1[_0x1feeb4(0x10f)])(_0x581059[_0x1feeb4(0x13d)]),'type':_0x1feeb4(0xed)};};exports[a81_0x36cca7(0x15e)]=getStream;async function generateThumbnail(_0x56ba43,_0xf00b9f,_0x56ba00){const _0x53da79=a81_0x36cca7;let _0x212f8a,_0x74f98c;if(_0xf00b9f===_0x53da79(0x135)){const {buffer:_0x15d078,original:_0x3f076d}=await(0x0,exports['extractImageThumb'])(_0x56ba43);_0x212f8a=_0x15d078[_0x53da79(0xfe)]('base64'),_0x3f076d[_0x53da79(0x11d)]&&_0x3f076d[_0x53da79(0x129)]&&(_0x74f98c={'width':_0x3f076d[_0x53da79(0x11d)],'height':_0x3f076d[_0x53da79(0x129)]});}else{if(_0xf00b9f===_0x53da79(0x136)){const _0x1039eb=(0x0,path_1[_0x53da79(0x16f)])(getTmpFilesDirectory(),(0x0,similary_1['generateMessageID'])()+'.jpg');try{await extractVideoThumb(_0x56ba43,_0x1039eb,'00:00:00',{'width':0x20,'height':0x20});const _0x59d06f=await fs_1[_0x53da79(0x179)]['readFile'](_0x1039eb);_0x212f8a=_0x59d06f[_0x53da79(0xfe)](_0x53da79(0x13e)),await fs_1[_0x53da79(0x179)][_0x53da79(0x166)](_0x1039eb);}catch(_0x4c8907){}}}return{'thumbnail':_0x212f8a,'originalImageDimensions':_0x74f98c};}exports[a81_0x36cca7(0xfc)]=generateThumbnail;const getHttpStream=async(_0x3ab068,_0x549a28={})=>{const _0x31b491=a81_0x36cca7,{default:_0x5ac883}=await Promise['resolve']()[_0x31b491(0x142)](()=>__importStar(require(_0x31b491(0x157)))),_0x1d4fd9=await _0x5ac883['get'](_0x3ab068[_0x31b491(0xfe)](),{..._0x549a28,'responseType':'stream'});return _0x1d4fd9[_0x31b491(0x105)];};exports[a81_0x36cca7(0x189)]=getHttpStream;const encryptedStream=async(_0x13b266,_0x3c7b03,{logger:_0xfae545,saveOriginalFileIfRequired:_0xa0fae0,opts:_0x31c740}={})=>{const _0x126772=a81_0x36cca7,{stream:_0xde0c25,type:_0x3fd395}=await(0x0,exports[_0x126772(0x15e)])(_0x13b266,_0x31c740),_0x3b3487=Crypto[_0x126772(0x150)](0x20),{cipherKey:_0x53b50f,iv:_0x517aef,macKey:_0x3ecb80}=getMediaKeys(_0x3b3487,_0x3c7b03),_0x3381af=new stream_1[(_0x126772(0xf1))]({'read':()=>{}});let _0x2aa7ab,_0x15d92a,_0xf21707=![];if(_0x3fd395===_0x126772(0xed))_0x2aa7ab=_0x13b266[_0x126772(0x13d)];else _0xa0fae0&&(_0x2aa7ab=(0x0,path_1[_0x126772(0x16f)])(getTmpFilesDirectory(),_0x3c7b03+(0x0,similary_1[_0x126772(0x123)])()),_0x15d92a=(0x0,fs_1['createWriteStream'])(_0x2aa7ab),_0xf21707=!![]);let _0x5b847e=0x0;const _0xb9a3de=Crypto[_0x126772(0x164)](_0x126772(0xf5),_0x53b50f,_0x517aef);let _0xb41af9=Crypto['createHmac'](_0x126772(0x169),_0x3ecb80)[_0x126772(0x18b)](_0x517aef),_0x9584b4=Crypto[_0x126772(0x190)]('sha256'),_0x2786f2=Crypto[_0x126772(0x190)](_0x126772(0x169));try{for await(const _0x1a89d3 of _0xde0c25){_0x5b847e+=_0x1a89d3['length'];if(_0x3fd395===_0x126772(0xf0)&&(_0x31c740===null||_0x31c740===void 0x0?void 0x0:_0x31c740[_0x126772(0x140)])&&_0x5b847e+_0x1a89d3[_0x126772(0x162)]>_0x31c740[_0x126772(0x140)])throw _0x126772(0xe9);_0x9584b4=_0x9584b4[_0x126772(0x18b)](_0x1a89d3),_0x15d92a&&(!_0x15d92a[_0x126772(0x14f)](_0x1a89d3)&&await(0x0,events_1[_0x126772(0x184)])(_0x15d92a,_0x126772(0x170))),_0x2074ab(_0xb9a3de[_0x126772(0x18b)](_0x1a89d3));}_0x2074ab(_0xb9a3de['final']());const _0x1186d6=_0xb41af9['digest']()[_0x126772(0x12e)](0x0,0xa);_0x2786f2=_0x2786f2[_0x126772(0x18b)](_0x1186d6);const _0x12a935=_0x9584b4[_0x126772(0x13a)](),_0x5b7cd9=_0x2786f2['digest']();return _0x3381af[_0x126772(0x173)](_0x1186d6),_0x3381af['push'](null),_0x15d92a===null||_0x15d92a===void 0x0?void 0x0:_0x15d92a[_0x126772(0x153)](),_0xde0c25['destroy'](),{'mediaKey':_0x3b3487,'encWriteStream':_0x3381af,'bodyPath':_0x2aa7ab,'mac':_0x1186d6,'fileEncSha256':_0x5b7cd9,'fileSha256':_0x12a935,'fileLength':_0x5b847e,'didSaveToTmpPath':_0xf21707};}catch(_0x5f09b4){_0x3381af['destroy'](),_0x15d92a===null||_0x15d92a===void 0x0?void 0x0:_0x15d92a[_0x126772(0x11e)](),_0xb9a3de[_0x126772(0x11e)](),_0xb41af9[_0x126772(0x11e)](),_0x9584b4[_0x126772(0x11e)](),_0x2786f2[_0x126772(0x11e)](),_0xde0c25['destroy']();if(_0xf21707)try{await fs_1[_0x126772(0x179)][_0x126772(0x166)](_0x2aa7ab);}catch(_0x41581c){}throw _0x126772(0x132);}function _0x2074ab(_0x45f3ed){const _0x2dd0d6=_0x126772;_0x2786f2=_0x2786f2[_0x2dd0d6(0x18b)](_0x45f3ed),_0xb41af9=_0xb41af9[_0x2dd0d6(0x18b)](_0x45f3ed),_0x3381af[_0x2dd0d6(0x173)](_0x45f3ed);}};exports[a81_0x36cca7(0x14e)]=encryptedStream;const DEF_HOST=a81_0x36cca7(0x16c),AES_CHUNK_SIZE=0x10,toSmallestChunkSize=_0x1c78f3=>{return Math['floor'](_0x1c78f3/AES_CHUNK_SIZE)*AES_CHUNK_SIZE;},getUrlFromDirectPath=_0x345768=>a81_0x36cca7(0x152)+DEF_HOST+_0x345768;exports[a81_0x36cca7(0xf8)]=getUrlFromDirectPath;const downloadContentFromMessage=({mediaKey:_0x57f39e,directPath:_0x3c7e0b,url:_0x40d22e},_0x7279e1,_0x573a81={})=>{const _0x33a4db=a81_0x36cca7,_0x5cc729=_0x40d22e||(0x0,exports[_0x33a4db(0xf8)])(_0x3c7e0b),_0x37f4e3=getMediaKeys(_0x57f39e,_0x7279e1);return(0x0,exports[_0x33a4db(0x10c)])(_0x5cc729,_0x37f4e3,_0x573a81);};exports[a81_0x36cca7(0x13c)]=downloadContentFromMessage;const downloadEncryptedContent=async(_0x294dff,{cipherKey:_0xcf4f4d,iv:_0x51a242},{startByte:_0x177227,endByte:_0x1fd6ed,options:_0x305b02}={})=>{const _0x5abb5d=a81_0x36cca7;let _0x5f219a=0x0,_0x1e5fe2=0x0,_0x43c53f=![];if(_0x177227){const _0x31eb02=toSmallestChunkSize(_0x177227||0x0);_0x31eb02&&(_0x1e5fe2=_0x31eb02-AES_CHUNK_SIZE,_0x5f219a=_0x31eb02,_0x43c53f=!![]);}const _0x29d11f=_0x1fd6ed?toSmallestChunkSize(_0x1fd6ed||0x0)+AES_CHUNK_SIZE:undefined,_0x5aa388={...(_0x305b02===null||_0x305b02===void 0x0?void 0x0:_0x305b02['headers'])||{},'Origin':mode_1['DEFAULT_ORIGIN']};(_0x1e5fe2||_0x29d11f)&&(_0x5aa388[_0x5abb5d(0x192)]='bytes='+_0x1e5fe2+'-',_0x29d11f&&(_0x5aa388[_0x5abb5d(0x192)]+=_0x29d11f));const _0x4d4413=await(0x0,exports[_0x5abb5d(0x189)])(_0x294dff,{..._0x305b02||{},'headers':_0x5aa388,'maxBodyLength':Infinity,'maxContentLength':Infinity});let _0x76c379=Buffer[_0x5abb5d(0x178)]([]),_0x2b8a91;const _0x42a956=(_0x3189cc,_0x32d413)=>{const _0x1a67d7=_0x5abb5d;if(_0x177227||_0x1fd6ed){const _0x1717c0=_0x5f219a>=_0x177227?undefined:Math[_0x1a67d7(0x143)](_0x177227-_0x5f219a,0x0),_0x1670d0=_0x5f219a+_0x3189cc[_0x1a67d7(0x162)]<_0x1fd6ed?undefined:Math[_0x1a67d7(0x143)](_0x1fd6ed-_0x5f219a,0x0);_0x32d413(_0x3189cc[_0x1a67d7(0x12e)](_0x1717c0,_0x1670d0)),_0x5f219a+=_0x3189cc[_0x1a67d7(0x162)];}else _0x32d413(_0x3189cc);},_0x46aa41=new stream_1[(_0x5abb5d(0x171))]({'transform'(_0x553a4e,_0x18ed10,_0x343683){const _0x36a860=_0x5abb5d;let _0x1c9615=Buffer[_0x36a860(0x17f)]([_0x76c379,_0x553a4e]);const _0x22734b=toSmallestChunkSize(_0x1c9615[_0x36a860(0x162)]);_0x76c379=_0x1c9615['slice'](_0x22734b),_0x1c9615=_0x1c9615[_0x36a860(0x12e)](0x0,_0x22734b);if(!_0x2b8a91){let _0xe5fb79=_0x51a242;_0x43c53f&&(_0xe5fb79=_0x1c9615['slice'](0x0,AES_CHUNK_SIZE),_0x1c9615=_0x1c9615[_0x36a860(0x12e)](AES_CHUNK_SIZE)),_0x2b8a91=Crypto[_0x36a860(0x12c)](_0x36a860(0xf5),_0xcf4f4d,_0xe5fb79),_0x1fd6ed&&_0x2b8a91[_0x36a860(0x11f)](![]);}try{_0x42a956(_0x2b8a91[_0x36a860(0x18b)](_0x1c9615),_0x407202=>this[_0x36a860(0x173)](_0x407202)),_0x343683();}catch(_0x1d19c2){_0x343683(_0x1d19c2);}},'final'(_0x5c3834){const _0x521653=_0x5abb5d;try{_0x42a956(_0x2b8a91[_0x521653(0x10d)](),_0x5eb080=>this[_0x521653(0x173)](_0x5eb080)),_0x5c3834();}catch(_0x4ceca0){_0x5c3834(_0x4ceca0);}}});return _0x4d4413[_0x5abb5d(0x17d)](_0x46aa41,{'end':!![]});};exports['downloadEncryptedContent']=downloadEncryptedContent;function extensionForMediaMessage(_0x351921){const _0x50a593=a81_0x36cca7,_0x31b7b5=_0x47caa2=>_0x47caa2[_0x50a593(0xfb)](';')[0x0]['split']('/')[0x1],_0x40d809=Object[_0x50a593(0x12f)](_0x351921)[0x0];let _0x35475c;if(_0x40d809===_0x50a593(0x196)||_0x40d809===_0x50a593(0x16a)||_0x40d809===_0x50a593(0x13f))_0x35475c=_0x50a593(0x195);else{const _0x56934c=_0x351921[_0x40d809];_0x35475c=_0x31b7b5(_0x56934c[_0x50a593(0x114)]);}return _0x35475c;}exports[a81_0x36cca7(0x11c)]=extensionForMediaMessage;const getWAUploadToServer=({customUploadHosts:_0xb5af87,fetchAgent:_0x4a5839,logger:_0x311945,options:_0x5ee209},_0x10404d)=>{return async(_0x3549a6,{mediaType:_0x59d49d,fileEncSha256B64:_0x11e94d,timeoutMs:_0xd6ac72})=>{const _0x548b2c=a81_0xab0f;var _0x1cabd5,_0xf83b71;const {default:_0x3a1094}=await Promise[_0x548b2c(0x127)]()[_0x548b2c(0x142)](()=>__importStar(require('axios')));let _0xa5dcc2=await _0x10404d(![]),_0x7cb3db;const _0xb38f09=[..._0xb5af87,..._0xa5dcc2[_0x548b2c(0x14b)]];_0x11e94d=(0x0,exports['encodeBase64EncodedStringForUpload'])(_0x11e94d);for(const {hostname:_0x7ab00e}of _0xb38f09){const _0x230129=encodeURIComponent(_0xa5dcc2[_0x548b2c(0x120)]),_0xe49505=_0x548b2c(0x152)+_0x7ab00e+mode_1[_0x548b2c(0x199)][_0x59d49d]+'/'+_0x11e94d+_0x548b2c(0x112)+_0x230129+_0x548b2c(0x155)+_0x11e94d;let _0xb61f16;try{const _0x34b839=await _0x3a1094['post'](_0xe49505,_0x3549a6,{..._0x5ee209,'headers':{..._0x5ee209[_0x548b2c(0x101)]||{},'Content-Type':_0x548b2c(0x181),'Origin':mode_1['DEFAULT_ORIGIN']},'httpsAgent':_0x4a5839,'timeout':_0xd6ac72,'responseType':_0x548b2c(0xf7),'maxBodyLength':Infinity,'maxContentLength':Infinity});_0xb61f16=_0x34b839[_0x548b2c(0x105)];if((_0xb61f16===null||_0xb61f16===void 0x0?void 0x0:_0xb61f16[_0x548b2c(0x13d)])||(_0xb61f16===null||_0xb61f16===void 0x0?void 0x0:_0xb61f16[_0x548b2c(0x15c)])){_0x7cb3db={'mediaUrl':_0xb61f16[_0x548b2c(0x13d)],'directPath':_0xb61f16[_0x548b2c(0x19a)]};break;}else{_0xa5dcc2=await _0x10404d(!![]);throw _0x548b2c(0x19d);}}catch(_0xa5498c){_0x3a1094[_0x548b2c(0xec)](_0xa5498c)&&(_0xb61f16=(_0x1cabd5=_0xa5498c[_0x548b2c(0x175)])===null||_0x1cabd5===void 0x0?void 0x0:_0x1cabd5[_0x548b2c(0x105)]);const _0x9df6c4=_0x7ab00e===((_0xf83b71=_0xb38f09[_0xa5dcc2[_0x548b2c(0x14b)]['length']-0x1])===null||_0xf83b71===void 0x0?void 0x0:_0xf83b71['hostname']);}}if(!_0x7cb3db)throw _0x548b2c(0x183);return _0x7cb3db;};};exports['getWAUploadToServer']=getWAUploadToServer;const getMediaRetryKey=_0x3032d4=>{const _0x456d62=a81_0x36cca7;return(0x0,enc_2[_0x456d62(0x19c)])(_0x3032d4,0x20,{'info':_0x456d62(0xfa)});},encryptMediaRetryRequest=(_0x2df5e8,_0x33b825,_0x36e5c7)=>{const _0x217a05=a81_0x36cca7,_0x2b7e80={'stanzaId':_0x2df5e8['id']},_0x30e770=enc_1[_0x217a05(0x139)]['ServerErrorReceipt'][_0x217a05(0x1a1)](_0x2b7e80)[_0x217a05(0x108)](),_0x48be56=Crypto['randomBytes'](0xc),_0x319559=getMediaRetryKey(_0x33b825),_0x3ec13b=(0x0,enc_2[_0x217a05(0x12a)])(_0x30e770,_0x319559,_0x48be56,Buffer[_0x217a05(0x178)](_0x2df5e8['id'])),_0x1470ad={'tag':_0x217a05(0x116),'attrs':{'id':_0x2df5e8['id'],'to':(0x0,Internal_1[_0x217a05(0x11a)])(_0x36e5c7),'type':_0x217a05(0x146)},'content':[{'tag':_0x217a05(0xf2),'attrs':{},'content':[{'tag':_0x217a05(0xeb),'attrs':{},'content':_0x3ec13b},{'tag':_0x217a05(0xea),'attrs':{},'content':_0x48be56}]},{'tag':'rmr','attrs':{'jid':_0x2df5e8['remoteJid'],'from_me':(!!_0x2df5e8[_0x217a05(0x149)])[_0x217a05(0xfe)](),'participant':_0x2df5e8[_0x217a05(0x110)]||undefined}}]};return _0x1470ad;};exports['encryptMediaRetryRequest']=encryptMediaRetryRequest;function a81_0x5a59(){const _0x41aca0=['true','MEDIA_HKDF_KEY_MAPPING','getWAUploadToServer','encryptMediaRetryRequest','directPath','http://','getStream','encodeBase64EncodedStringForUpload','function','resize','length','jid','createCipheriv','getWidth','unlink','SUCCESS','190850oyGtsf','sha256','liveLocationMessage','writable','mmg.whatsapp.net','default','MediaRetryNotification','join','drain','Transform','child_process','push','music-metadata','response','pow','getAudioDuration','from','promises','string','getMediaKeys','Erro\x20de\x20midia','pipe','attrs','concat','sharp','application/octet-stream','events','erro\x20no\x20arquivo','once','78xYwFqp','../../Connection/mode','from_me','floor','getHttpStream','getStatusCodeForMediaRetry','update','562036AEskRb','stream','defineProperty','getHeight','createHash','../crypto/enc','Range','rmr','error','.jpeg','locationMessage','extractImageThumb','path','MEDIA_PATH_MAP','direct_path','522536kCuNPW','hkdf','upload','tmpdir','jpeg','create','encode','getBinaryNodeChild','hasOwnProperty','erro\x20tamanho\x20remoto','enc_iv','enc_p','isAxiosError','file','prototype','getOwnPropertyDescriptor','remote','Readable','encrypt','abs','getBinaryNodeChildBuffer','aes-256-cbc','generateProfilePicture','json','getUrlFromDirectPath','Bibliotecas\x20Jimp\x20e\x20Sharp\x20Faltando!','WhatsApp\x20Media\x20Retry\x20Notification','split','generateThumbnail','audio-decode','toString','metadata','map','headers','parseBuffer','duration','mediaMessageSHA256B64','data','925647QlSmlf','erro\x20midia','finish','NOT_FOUND','isBuffer','startsWith','downloadEncryptedContent','final','4695183ZQUzrl','createReadStream','participant','call','?auth=','decodeMediaRetryNode','mimetype','toReadable','receipt','../crypto/similary','getChannelData','parseStream','jidNormalizedUser','catch','extensionForMediaMessage','width','destroy','setAutoPadding','auth','toBuffer','format','generateMessageID','getBufferAsync','7cARuDF','all','resolve','crop','height','aesEncryptGCM','aesDecryptGCM','createDecipheriv','read','slice','keys','ResultType','425400xqjsyl','erro\x20topo','__esModule','151925HdvHZR','image','video','data:;base64,','ffmpeg\x20-ss\x20','proto','digest','jimp','downloadContentFromMessage','url','base64','productMessage','maxContentLength','__setModuleDefault','then','max','hkdfInfoKey','fileSha256','server-error','replace','code','fromMe','__createBinding','hosts','readable','decryptMediaRetryData','encryptedStream','write','randomBytes','get','https://','end','getAudioWaveform','&token=','WhatsApp\x20','axios'];a81_0x5a59=function(){return _0x41aca0;};return a81_0x5a59();}const decodeMediaRetryNode=_0x803681=>{const _0x1e6d0f=a81_0x36cca7,_0x176d53=(0x0,Internal_1[_0x1e6d0f(0xe7)])(_0x803681,_0x1e6d0f(0x193)),_0x16fc3d={'key':{'id':_0x803681[_0x1e6d0f(0x17e)]['id'],'remoteJid':_0x176d53[_0x1e6d0f(0x17e)][_0x1e6d0f(0x163)],'fromMe':_0x176d53[_0x1e6d0f(0x17e)][_0x1e6d0f(0x187)]===_0x1e6d0f(0x158),'participant':_0x176d53[_0x1e6d0f(0x17e)][_0x1e6d0f(0x110)]}},_0x1f3d45=(0x0,Internal_1[_0x1e6d0f(0xe7)])(_0x803681,_0x1e6d0f(0x194));if(_0x1f3d45){const _0x42c686=+_0x1f3d45[_0x1e6d0f(0x17e)][_0x1e6d0f(0x148)];_0x16fc3d[_0x1e6d0f(0x194)]=undefined;}else{const _0x588b4a=(0x0,Internal_1[_0x1e6d0f(0xe7)])(_0x803681,_0x1e6d0f(0xf2)),_0x48d664=(0x0,Internal_1[_0x1e6d0f(0xf4)])(_0x588b4a,_0x1e6d0f(0xeb)),_0x41fc0b=(0x0,Internal_1['getBinaryNodeChildBuffer'])(_0x588b4a,'enc_iv');_0x48d664&&_0x41fc0b?_0x16fc3d['media']={'ciphertext':_0x48d664,'iv':_0x41fc0b}:_0x16fc3d[_0x1e6d0f(0x194)]=undefined;}return _0x16fc3d;};function a81_0xab0f(_0x307236,_0x4ba530){const _0x5a591f=a81_0x5a59();return a81_0xab0f=function(_0xab0fd4,_0x1ec784){_0xab0fd4=_0xab0fd4-0xe7;let _0x18456f=_0x5a591f[_0xab0fd4];return _0x18456f;},a81_0xab0f(_0x307236,_0x4ba530);}exports[a81_0x36cca7(0x113)]=decodeMediaRetryNode;const decryptMediaRetryData=({ciphertext:_0x20a77a,iv:_0x2f2598},_0x24d2ea,_0x359309)=>{const _0x5c068b=a81_0x36cca7,_0x240391=getMediaRetryKey(_0x24d2ea),_0x3687f3=(0x0,enc_2[_0x5c068b(0x12b)])(_0x20a77a,_0x240391,_0x2f2598,Buffer[_0x5c068b(0x178)](_0x359309));return enc_1[_0x5c068b(0x139)][_0x5c068b(0x16e)]['decode'](_0x3687f3);};exports[a81_0x36cca7(0x14d)]=decryptMediaRetryData;const getStatusCodeForMediaRetry=_0x8e5c9f=>MEDIA_RETRY_STATUS_MAP[_0x8e5c9f];exports[a81_0x36cca7(0x18a)]=getStatusCodeForMediaRetry;const MEDIA_RETRY_STATUS_MAP={[enc_1[a81_0x36cca7(0x139)]['MediaRetryNotification'][a81_0x36cca7(0x130)][a81_0x36cca7(0x167)]]:0xc8,[enc_1[a81_0x36cca7(0x139)][a81_0x36cca7(0x16e)]['ResultType']['DECRYPTION_ERROR']]:0x19c,[enc_1[a81_0x36cca7(0x139)]['MediaRetryNotification']['ResultType'][a81_0x36cca7(0x109)]]:0x194,[enc_1[a81_0x36cca7(0x139)][a81_0x36cca7(0x16e)][a81_0x36cca7(0x130)]['GENERAL_ERROR']]:0x1a2};function __importStar(_0x5c66e4){throw'erro\x20de\x20midia';}