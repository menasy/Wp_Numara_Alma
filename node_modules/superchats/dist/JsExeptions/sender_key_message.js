function a37_0x4cd9(_0x43f4f2,_0x2ec205){const _0x284748=a37_0x2847();return a37_0x4cd9=function(_0x4cd919,_0x3b3058){_0x4cd919=_0x4cd919-0xfb;let _0x3ed104=_0x284748[_0x4cd919];return _0x3ed104;},a37_0x4cd9(_0x43f4f2,_0x2ec205);}function a37_0x2847(){const _0xd4acc7=['ciphertext','iteration','3MKFtvT','serialized','length','SIGNATURE_LENGTH','getType','./protobufs','6559CiIDBZ','verifySignature','9918ofplaM','decode','CURRENT_VERSION','getKeyId','./ciphertext_message','SenderKeyMessage','12012720ttZtyb','getSignature','encode','1608476umoaJC','signature','slice','exports','1654596wwhgFM','getIteration','1320912HnDkby','finish','concat','895881aWAYqi','280zBgflc','serialize','from','1521635svyZSn','messageVersion'];a37_0x2847=function(){return _0xd4acc7;};return a37_0x2847();}const a37_0x17e06e=a37_0x4cd9;(function(_0x1d659c,_0xf7ccf3){const _0x4e57ed=a37_0x4cd9,_0x4e47ce=_0x1d659c();while(!![]){try{const _0x8774b3=-parseInt(_0x4e57ed(0x10a))/0x1+parseInt(_0x4e57ed(0x105))/0x2+parseInt(_0x4e57ed(0x112))/0x3*(-parseInt(_0x4e57ed(0x101))/0x4)+parseInt(_0x4e57ed(0x10e))/0x5+parseInt(_0x4e57ed(0x11a))/0x6*(-parseInt(_0x4e57ed(0x118))/0x7)+-parseInt(_0x4e57ed(0xfe))/0x8+-parseInt(_0x4e57ed(0x107))/0x9*(-parseInt(_0x4e57ed(0x10b))/0xa);if(_0x8774b3===_0xf7ccf3)break;else _0x4e47ce['push'](_0x4e47ce['shift']());}catch(_0x6e0417){_0x4e47ce['push'](_0x4e47ce['shift']());}}}(a37_0x2847,0xd9f06));const CiphertextMessage=require(a37_0x17e06e(0xfc)),curve=require('super-libsignal/src/curve'),protobufs=require(a37_0x17e06e(0x117));class SenderKeyMessage extends CiphertextMessage{[a37_0x17e06e(0x115)]=0x40;constructor(_0x25793d=null,_0x38d002=null,_0x17470c=null,_0x382922=null,_0x3aade2=null){const _0x379dbc=a37_0x17e06e;super();if(_0x3aade2){const _0x4ac89e=_0x3aade2[0x0],_0x37ddda=_0x3aade2[_0x379dbc(0x103)](0x1,_0x3aade2[_0x379dbc(0x114)]-this['SIGNATURE_LENGTH']),_0x32c018=_0x3aade2[_0x379dbc(0x103)](-0x1*this['SIGNATURE_LENGTH']),_0x1257b2=protobufs['SenderKeyMessage'][_0x379dbc(0x11b)](_0x37ddda)['toJSON']();_0x1257b2[_0x379dbc(0x110)]=Buffer[_0x379dbc(0x10d)](_0x1257b2[_0x379dbc(0x110)],'base64'),this[_0x379dbc(0x113)]=_0x3aade2,this['messageVersion']=(_0x4ac89e&0xff)>>0x4,this['keyId']=_0x1257b2['id'],this['iteration']=_0x1257b2[_0x379dbc(0x111)],this[_0x379dbc(0x110)]=_0x1257b2[_0x379dbc(0x110)],this[_0x379dbc(0x102)]=_0x32c018;}else{const _0x5e3eaa=((this[_0x379dbc(0x11c)]<<0x4|this['CURRENT_VERSION'])&0xff)%0x100;_0x17470c=Buffer[_0x379dbc(0x10d)](_0x17470c);const _0x26fd35=protobufs[_0x379dbc(0xfd)][_0x379dbc(0x100)](protobufs[_0x379dbc(0xfd)]['create']({'id':_0x25793d,'iteration':_0x38d002,'ciphertext':_0x17470c}))[_0x379dbc(0x108)](),_0x250a6e=this[_0x379dbc(0xff)](_0x382922,Buffer[_0x379dbc(0x109)]([Buffer['from']([_0x5e3eaa]),_0x26fd35]));this[_0x379dbc(0x113)]=Buffer[_0x379dbc(0x109)]([Buffer[_0x379dbc(0x10d)]([_0x5e3eaa]),_0x26fd35,Buffer['from'](_0x250a6e)]),this[_0x379dbc(0x10f)]=this[_0x379dbc(0x11c)],this['keyId']=_0x25793d,this[_0x379dbc(0x111)]=_0x38d002,this[_0x379dbc(0x110)]=_0x17470c,this[_0x379dbc(0x102)]=_0x250a6e;}}[a37_0x17e06e(0xfb)](){return this['keyId'];}[a37_0x17e06e(0x106)](){return this['iteration'];}['getCipherText'](){const _0x21764c=a37_0x17e06e;return this[_0x21764c(0x110)];}['verifySignature'](_0x2dabae){const _0x139a17=a37_0x17e06e,_0x3793b9=this[_0x139a17(0x113)][_0x139a17(0x103)](0x0,this['serialized'][_0x139a17(0x114)]-this['SIGNATURE_LENGTH']),_0xfa4591=this[_0x139a17(0x113)][_0x139a17(0x103)](-0x1*this['SIGNATURE_LENGTH']),_0x1a69fa=curve[_0x139a17(0x119)](_0x2dabae,_0x3793b9,_0xfa4591);if(!_0x1a69fa)throw new Error('Invalid\x20signature!');}[a37_0x17e06e(0xff)](_0x1150e2,_0x1114be){const _0x31ca91=a37_0x17e06e,_0x218408=Buffer[_0x31ca91(0x10d)](curve['calculateSignature'](_0x1150e2,_0x1114be));return _0x218408;}[a37_0x17e06e(0x10c)](){return this['serialized'];}[a37_0x17e06e(0x116)](){return 0x4;}}module[a37_0x17e06e(0x104)]=SenderKeyMessage;